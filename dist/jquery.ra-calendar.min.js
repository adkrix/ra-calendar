$.RaCalendar={version:"<%= meta.version %>",elements:{root:null,header:null,resources:null,content:null},config:{date:{begin_time:"09:00:00",duration:3600,round:"15m"},events:{id:"id",resource_id:"resource_id",title:"name",begin:"begin",end:"end",duration:"",url:"url"},resources:{id:"",title:"name"}},events:[],resorces:[],default_color:{color:"#000000",background:"#eeeeee"}},$.RaCalendar.methods={tmpl:function(e,t){return e.replace(/\{([\w\.]*)\}/g,function(e,n){var r,a,o,i;for(r=n.split("."),a=t[r.shift()],o=0,i=r.length;i>o;o++)n=r[o],a=a[n];return"undefined"!=typeof a&&null!==a?a:""})},normalizeEvent:function(e,t){var n,r;return n=this.base.config,r={id:e[n.events.id]?e[n.events.id]:t,resource_id:e[n.events.resource_id]?e[n.events.resource_id]:0,title:e[n.events.title],begin:this.date.round(e[n.events.begin],n.date.round),event:e,url:e[n.events.url]?e[n.events.url]:""},r.end=n.events.end&&e[n.events.end]?this.date.round(e[n.events.end],n.date.round):n.events.duration&&e[n.events.duration]?this.date.round(this.date.update(r.begin,e[n.events.duration]),n.date.round):n.date.duration?this.date.round(this.date.update(r.begin,n.date.duration),n.date.round):void 0,r},updateEvents:function(e){var t;return t=this,this.base.events=e?$.map(e,function(e,n){return t.normalizeEvent(e,n)}):[],console.log(this.base.events,e)},updateResources:function(e){return e}},$.RaCalendar.methods.date={isLeapYear:function(e){return e%4===0&&e%100!==0||e%400===0},getDaysInMonth:function(e,t){var n;return[31,null!=(n=this.isLeapYear(e))?n:{29:28},31,30,31,30,31,31,30,31,30,31][t]},clone:function(e){return new Date(e.getTime())},parse:function(e){return new Date(Date.parse(e))},format:function(e,t){return DateFormat.format.date(e,t)},reformat:function(e,t){return this.format(this.parseDate(e),t)},normalize:function(e){return e?"number"==typeof e?new Date(e):"object"==typeof e?this.clone(e):this.parse(e):$.now()},round:function(e,t){return t=function(){switch(t){case"1m":return 6e4;case"5m":return 3e5;case"10m":return 6e5;case"15m":return 9e5;case"30m":return 18e5;default:return 6e4}}(),new Date(Math.floor(new Date(e).getTime()/t)*t)},update:function(e,t){return this.normalize(e).setSeconds(t)}},$.RaCalendar.template={header:{main:"<div class='ra-header'>header</div>"},resources:{main:"<div class='ra-resources'>resources</div>"},content:{main:"<div class='ra-content'>content</div>"},ul:"<ul>{list}</ul>",li_link:"<li><a href='{url}'>{title}</a></li>",li_div:"<li><div>{title}</div> </li>"},$.fn.RaCalendar=function(e){return $(this).each(function(){var t,n,r,a,o,i;return t=$.extend(!0,{},$.RaCalendar),r=t.elements,r.root=$(this).empty(),n=t.config,e.config&&$.extend(!0,n,e.config),o=t.template,e.template&&$.extend(!0,o,e.template),a=t.methods,t.methods.base=t,e.parseDate&&(a.date.parse=e.parseDate),e.formatDate&&(a.date.format=e.formatDate),t.date=a.date.normalize(e.date),a.updateEvents(e.events),a.updateResources(e.resources),r.header=$(o.header.main).appendTo(r.root),r.resources=$(o.resources.main).appendTo(r.root),r.content=$(o.content.main).appendTo(r.root),i="",$.each(t.events,function(e,t){return i+=t.url?a.tmpl(o.li_link,t):a.tmpl(o.li_div,t)}),r.content.html(a.tmpl(o.ul,{list:i})),console.log(1212)})};